{
  "v": 3,
  "task": "WP-032",
  "status": "DONE",
  "subtasks_completed": [
    "1. Added turn limit validation in runBuilder before invocation",
    "2. Validated task.builder.max_turns >= 1 (via Math.max(1, ...))",
    "3. Capped task.builder.max_turns to config.builder.claude_code.max_turns if exceeded",
    "4. Added turnsUsed field to BuilderInvocationResult (extracted from raw response num_turns if available)",
    "5. Added turnsRequested field to BuilderInvocationResult for tracking",
    "6. Added warning log when task turns are capped"
  ],
  "git_diff_files": ["src/runner/builder.ts"],
  "files": {
    "changed": ["src/runner/builder.ts"],
    "created": [],
    "deleted": []
  },
  "verify": [
    {
      "cmd": "pnpm build",
      "exit": 0,
      "output": "> relais@1.0.0 build /Users/clement/projects/relais\n> tsc"
    }
  ],
  "notes": [
    "Turn limit validation now clamps requested turns to range [1, config.builder.claude_code.max_turns]",
    "Warning is logged when clamping occurs, showing original value, clamped value, and limit",
    "turnsRequested tracks the original requested value (before clamping)",
    "turnsUsed extracts num_turns from Claude CLI raw response if available, otherwise null",
    "All BuilderInvocationResult return paths now include turnsRequested and turnsUsed fields"
  ],
  "blockers": []
}
