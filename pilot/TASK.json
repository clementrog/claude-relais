{
  "v": 5,
  "id": "WP-051",
  "milestone": "M6",
  "goal": "Implement REPORT.md rendering from REPORT.json",

  "context": {
    "why": "REPORT.md is a deterministic, human-readable rendering of REPORT.json. The orchestrator reads this markdown to understand tick results. It must be generated from REPORT.json, never the other way around.",
    "deps": ["WP-050"],
    "extract": "From PRD: REPORT.md is a deterministic rendering of REPORT.json (human/orchestrator friendly). Runner must generate REPORT.md from REPORT.json."
  },

  "subtasks": [
    "1. Add renderReportMarkdown function to src/lib/report.ts",
    "2. Generate markdown header with run_id, timestamps, verdict, code",
    "3. Render task summary section (task_id, milestone, intent)",
    "4. Render blast radius section with file/line counts",
    "5. Render scope section with violations if any",
    "6. Render verification results with pass/fail for each run",
    "7. Render budgets summary",
    "8. Add writeReportMarkdown(report, path) function",
    "9. Export new functions from src/lib/index.ts"
  ],

  "implementation": {
    "markdown_sections": [
      "# Relais Run Report",
      "## Summary (run_id, timestamps, verdict, code)",
      "## Task (task_id, milestone, kind, intent)",
      "## Blast Radius (files_touched, lines_added, lines_deleted, new_files)",
      "## Scope (ok/violations list)",
      "## Verification (table: template_id, phase, exit_code, duration)",
      "## Budgets (ticks, calls, cost)"
    ],
    "formatting": {
      "verdict_success": "✓ SUCCESS",
      "verdict_stop": "✗ STOP: <code>",
      "verdict_blocked": "⚠ BLOCKED: <code>"
    }
  },

  "scope": {
    "write": ["src/lib/report.ts", "src/lib/index.ts"],
    "create_under": [],
    "read_forbidden": [".env*", "*.pem", "*.key"],
    "forbidden": ["pilot/*", "relais/*", "package.json"]
  },

  "acceptance": [
    "renderReportMarkdown produces valid markdown from ReportData",
    "All sections are included with proper formatting",
    "Verification runs shown in table format",
    "Scope violations listed if any",
    "writeReportMarkdown writes file to disk",
    "pnpm build succeeds"
  ],

  "verify": ["pnpm build"],
  "risk": "LOW",
  "notes": [
    "Markdown should be deterministic (same input = same output)",
    "Use simple markdown formatting (headers, tables, lists)"
  ]
}
