{
  "v": 5,
  "id": "WP-072",
  "milestone": "M8",
  "goal": "Create reviewer_result.schema.json and reviewer prompts",

  "context": {
    "why": "The reviewer needs a JSON schema for validating its output and prompts to guide its decisions (proceed, force_patch, ask_question).",
    "deps": ["WP-071"],
    "extract": "From PRD Appendix C5: reviewer_result.schema.json with decision enum, reason_short, optional risk_flags array, optional patch_hint, optional question object. System prompt defines reviewer role, user prompt template has RISK_FLAGS, TASK_JSON, LAST_REPORT_MD, DIFF_PATCH, VERIFY_LOG, TOUCHED_PATHS placeholders."
  },

  "subtasks": [
    "1. Create relais/schemas/reviewer_result.schema.json per C5.1",
    "2. Create relais/prompts/reviewer.system.txt per C5.2",
    "3. Create relais/prompts/reviewer.user.txt per C5.3"
  ],

  "implementation": {
    "schema": {
      "required": ["decision", "reason_short"],
      "decision_enum": ["proceed", "force_patch", "ask_question"],
      "conditional": "if decision=ask_question then question required"
    },
    "prompts": {
      "system": "Define reviewer role, hard rules (JSON only, read-only, safety first), decision meanings",
      "user": "Template with {{RISK_FLAGS}}, {{TASK_JSON}}, {{LAST_REPORT_MD}}, {{DIFF_PATCH_OR_EMPTY}}, {{VERIFY_LOG_EXCERPT_OR_EMPTY}}, {{TOUCHED_PATHS}}"
    }
  },

  "scope": {
    "write": ["relais/schemas/reviewer_result.schema.json", "relais/prompts/reviewer.system.txt", "relais/prompts/reviewer.user.txt"],
    "create_under": ["relais/schemas/", "relais/prompts/"],
    "read_forbidden": [".env*", "*.pem", "*.key"],
    "forbidden": ["pilot/*", "src/**", "tests/**"]
  },

  "acceptance": [
    "reviewer_result.schema.json validates decision, reason_short, risk_flags, patch_hint, question",
    "Schema has conditional: ask_question requires question object",
    "reviewer.system.txt defines role and hard rules",
    "reviewer.user.txt has all 6 template placeholders",
    "JSON schema is valid (can be parsed)"
  ],

  "verify": ["node -e \"require('./relais/schemas/reviewer_result.schema.json')\""],
  "risk": "LOW",
  "notes": [
    "Follow existing schema style in relais/schemas/",
    "Follow existing prompt style in relais/prompts/"
  ]
}
