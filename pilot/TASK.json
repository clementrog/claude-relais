{
  "v": 5,
  "id": "WP-070",
  "milestone": "M8",
  "goal": "Add reviewer config types to src/types/config.ts",

  "context": {
    "why": "Implement the foundation for Review Escalation feature (Appendix C). The reviewer section in relais.config.json controls Codex CLI integration for a 'Second Brain' reviewer that triggers on risky situations.",
    "deps": ["WP-062"],
    "extract": "From PRD Appendix C2: reviewer config with enabled, engine, command, model, max_turns, max_budget_usd, auth (mode, ci_requires_api_key, api_key_env), trigger (on_verify_fail, on_repeated_stop, stop_window_ticks, max_stops_in_window, on_high_risk_paths, high_risk_globs, diff_fraction_threshold), schema_file, system_prompt_file, user_prompt_file."
  },

  "subtasks": [
    "1. Add ReviewerAuthConfig interface (mode: 'auto'|'api_key'|'login', ci_requires_api_key, api_key_env)",
    "2. Add ReviewerTriggerConfig interface (on_verify_fail, on_repeated_stop, stop_window_ticks, max_stops_in_window, on_high_risk_paths, high_risk_globs, diff_fraction_threshold)",
    "3. Add ReviewerConfig interface (enabled, engine, command, model, max_turns, max_budget_usd, auth, trigger, schema_file, system_prompt_file, user_prompt_file)",
    "4. Add optional reviewer field to RelaisConfig interface",
    "5. Export new types from src/types/index.ts"
  ],

  "implementation": {
    "interfaces": {
      "ReviewerAuthConfig": "mode, ci_requires_api_key, api_key_env",
      "ReviewerTriggerConfig": "on_verify_fail, on_repeated_stop, stop_window_ticks, max_stops_in_window, on_high_risk_paths, high_risk_globs, diff_fraction_threshold",
      "ReviewerConfig": "enabled, engine, command, model, max_turns, max_budget_usd, auth, trigger, schema_file, system_prompt_file, user_prompt_file"
    },
    "notes": "reviewer is optional in RelaisConfig (feature can be disabled)"
  },

  "scope": {
    "write": ["src/types/config.ts", "src/types/index.ts"],
    "create_under": [],
    "read_forbidden": [".env*", "*.pem", "*.key"],
    "forbidden": ["pilot/*", "relais/*", "tests/**"]
  },

  "acceptance": [
    "ReviewerAuthConfig interface defined with mode, ci_requires_api_key, api_key_env",
    "ReviewerTriggerConfig interface defined with all 7 trigger fields",
    "ReviewerConfig interface defined with all fields from C2",
    "RelaisConfig has optional reviewer?: ReviewerConfig field",
    "New types exported from index.ts",
    "pnpm build succeeds"
  ],

  "verify": ["pnpm build"],
  "risk": "LOW",
  "notes": [
    "This is the foundation task - types only, no implementation",
    "Follow existing code style in config.ts (JSDoc comments on interfaces)"
  ]
}
